### 说明文档

###### 游戏规则

坑棋（Pit Chess）是一款老少咸宜的益智棋类游戏，两名玩家掌握的两枚棋子分别从棋盘两角出发，先到达对方初始位置者即获得胜利。在此过程中，每回合玩家可以选择两种操作：

1\. 向上下左右相邻一格移动

先手：w、a、s、d对应上、下、左、右

后手：i 、k、j 、l对应上、下、左、右

2\. 在棋盘任意空白位置放置大小为 1×2 的砖块，砖块可以阻挡棋子

先手按下 q 进行放置，后手按下 p 进行放置，长按鼠标左键并拖动以完成放置，过程中按下任意键取消。

**注意：**

1\. 砖块数量有限，后手比先手多一块

2\. 玩家可以在设置中调节棋盘大小、砖块个数以及操作界面

3\. 任何回合放置砖块都不能将某一名玩家的路封死

###### 开发过程与详细功能

本游戏由Python编写，使用opencv、tkinter库制作UI交互界面。由主界面与下棋过程界面开始，不断增加游戏功能，包括存档、参数设置、界面调整、帮助、新手教程、用户页面等等，同时通过Python设计了两个难度不同的机器人。目前已开发的所有功能如下：

1.  新手教程

对于第一次游玩的用户（通过识别data目录是否存在），游戏将：

1）询问其用户名

2）自动为其新建data目录，同时新建其用户信息目录（文件夹名与其用户名相同）

3）显示_帮助_

4）进入_人机模式_（参数：难度1，玩家后手）

如果data目录已存在，则直接进入_主界面_

1.  主界面

主界面将提供以下交互操作：

1）按空格或点击相应按钮，进入_新游戏_

2）按P或点击相应按钮，进入_存档_

3）按R或点击相应按钮，进入_人机模式_

4）按S或点击相应按钮，进入_设置_

5）按H或点击相应按钮，进入_帮助_

6）按Enter或点击左上角用户名，进入_用户页面_

1.  **新游戏**

进入新游戏时，游戏将为用户初始化棋盘参数、游戏参数并生成棋盘图像。

此后_开始游戏_

1.  **存档**

进入存档时，游戏将读取Previous文档中的游戏参数

此后_开始游戏_

1.  **人机模式**

进入人机模式前，游戏将通过弹窗询问：

1.  先后手，点击cancel返回_主界面_
2.  机器人难度，点击cancel返回_主界面_

然后游戏将为用户初始化棋盘参数、游戏参数，生成棋盘图像，并根据所选机器人难度调用robot1/robot2文件。此后_开始游戏_

1.  **设置**

进入设置后，游戏将：

1.  通过弹窗询问棋盘大小与先手砖数，点击cancel退出_设置_
2.  显示主题背景，按空格切换主题，按Enter继续
3.  显示游戏界面，用方向键调整提示框位置，按Enter继续
4.  显示游戏界面，用方向键调整棋盘位置，按Enter结束设置

以上每一步按ESC都将退出_设置_。

结束设置后，游戏将保存用户的设置参数于Data文档中，并返回_主界面_

1.  **帮助**

显示帮助页面，按ESC或关闭窗口都将返回_主界面_

1.  **用户页面**

进入用户页面时，游戏将读取Record文档中的游戏记录并生成界面。用户页面提供以下交互操作：

1.  点击用户名，游戏将弹窗询问是否改名以及新用户名，点击cancel返回
2.  按S或点击右下角划线文字，游戏将弹窗询问是否切换账户以及用户名，点击cancel返回。若识别到用户名目录存在，则重新读取用户数据并进入_主界面_，否则通过弹窗询问是否新建用户，如果是则进入_新手教程_

用户页面按任意键或关闭窗口将返回_主界面_

1.  **开始游戏**

开始游戏前，游戏将根据已有数据生成界面背景与棋盘视图，并存档至Previous文档。

每回合开始时，游戏将更新棋盘视图与文字提示并显示。

1.  玩家回合操作方式见_游戏规则_。回合中按ESC或关闭窗口，游戏将自动将当前棋盘情况保存至Previous文档中。回合中按ESC将返回_主界面_
2.  机器人回合时，游戏将显示虚拟机器人形象与专属文字提示。游戏将自动引用机器人程序进行操作。

每回合结束时，游戏都会判断胜负。如果是人机模式中玩家获胜，则自动将战绩更新至Record文档中。

###### 其他亮点

1.  本游戏最为关键的规则在于任何回合放置砖块都不能将某一名玩家的路封死，而开发者巧妙地设计了函数以达到识别操作是否合法的目的，并实现于交互操作中。在游戏开发过程中也经过大量测试，使游戏总可以正常运行。
2.  设置界面中调整界面样式时的界面交互设计十分清晰。
3.  游戏做到了背景与前景的良好融合，并能够让用户自由切换背景。
4.  开发者花费很大精力自学了opencv的鼠标回调功能，并在画图软件中一块一块地记录按钮位置以达到主界面、用户界面上鼠标预选提示的效果。
5.  游戏中放砖操作与鼠标回调函数的融合经过高度完善，不仅可以自动排除非法操作，还能够用阴影提示放砖位置的预览。
6.  游戏中许多界面之间做到了渐变切换，给用户十分良好的视觉体验。
7.  开发者花费很大精力设计了两个机器人，难度不同供玩家选择。同时十分完善地实现了机器人程序在游戏程序中的接入。
8.  游戏对于新手十分友好，新手可以在游戏内直接体验新手教程而无需阅读说明文档。
9.  游戏可独立地保存多个用户的信息以及其各自击败机器人的次数，让单机游玩同样十分具有乐趣。
10.  游戏源代码注释完善，结构清晰。
11.  开发者在开发过程中精益求精，力求添加足够丰富的功能。游戏经过大量测试，开发过程历经近一个月以及十几个版本更迭（如下图），实乃开发者苦心孤诣之作！
